{
    "version": "1.102.0",
    "results": [
        {
            "check_id": "python.flask.security.audit.debug-enabled.debug-enabled",
            "path": "BigQuery-Python/app.py",
            "start": {
                "line": 6,
                "col": 5,
                "offset": 154
            },
            "end": {
                "line": 6,
                "col": 24,
                "offset": 173
            },
            "extra": {
                "metavars": {
                    "$APP": {
                        "start": {
                            "line": 6,
                            "col": 5,
                            "offset": 154
                        },
                        "end": {
                            "line": 6,
                            "col": 8,
                            "offset": 157
                        },
                        "abstract_content": "app app"
                    }
                },
                "message": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.",
                "metadata": {
                    "cwe": [
                        "CWE-489: Active Debug Code"
                    ],
                    "owasp": "A06:2017 - Security Misconfiguration",
                    "references": [
                        "https://labs.detectify.com/2015/10/02/how-patreon-got-hacked-publicly-exposed-werkzeug-debugger/"
                    ],
                    "category": "security",
                    "technology": [
                        "flask"
                    ],
                    "subcategory": [
                        "vuln"
                    ],
                    "likelihood": "HIGH",
                    "impact": "MEDIUM",
                    "confidence": "HIGH",
                    "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
                    "vulnerability_class": [
                        "Active Debug Code"
                    ],
                    "source": "https://semgrep.dev/r/python.flask.security.audit.debug-enabled.debug-enabled",
                    "shortlink": "https://sg.run/dKrd",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9534,
                            "rule_id": "gxU1bd",
                            "rule_name": "python.flask.security.audit.debug-enabled.debug-enabled",
                            "rv_id": 946206,
                            "url": "https://semgrep.dev/playground/r/8KTKjwR/python.flask.security.audit.debug-enabled.debug-enabled",
                            "version_id": "8KTKjwR"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    },
                    "semgrep.url": "https://semgrep.dev/r/python.flask.security.audit.debug-enabled.debug-enabled",
                    "semgrep.ruleset": "comment",
                    "semgrep.ruleset_id": 9381
                },
                "severity": "WARNING",
                "fingerprint": "03a08348139be0197be03890b9ea846c8eb2eb77c25eab18947410614211ffcd7319aa011e9b4698026ff9b430e51c8b6dce1e4faa0ee35d5a0309694ddc2b5a_0",
                "lines": "    app.run(debug=True)",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "engine_kind": "PRO"
            }
        },
        {
            "check_id": "python.django.security.django-no-csrf-token.django-no-csrf-token",
            "path": "BigQuery-Python/templates/login.html",
            "start": {
                "line": 11,
                "col": 5,
                "offset": 245
            },
            "end": {
                "line": 21,
                "col": 12,
                "offset": 602
            },
            "extra": {
                "metavars": {
                    "$1": {
                        "start": {
                            "line": 1,
                            "col": 1,
                            "offset": 0
                        },
                        "end": {
                            "line": 1,
                            "col": 5,
                            "offset": 4
                        },
                        "abstract_content": "POST"
                    },
                    "$METHOD": {
                        "start": {
                            "line": 11,
                            "col": 19,
                            "offset": 259
                        },
                        "end": {
                            "line": 11,
                            "col": 23,
                            "offset": 263
                        },
                        "abstract_content": "POST"
                    }
                },
                "message": "Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.",
                "metadata": {
                    "category": "security",
                    "cwe": "CWE-352: Cross-Site Request Forgery (CSRF)",
                    "references": [
                        "https://docs.djangoproject.com/en/4.2/howto/csrf/"
                    ],
                    "confidence": "MEDIUM",
                    "likelihood": "MEDIUM",
                    "impact": "MEDIUM",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "django"
                    ],
                    "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
                    "vulnerability_class": [
                        "Cross-Site Request Forgery (CSRF)"
                    ],
                    "source": "https://semgrep.dev/r/python.django.security.django-no-csrf-token.django-no-csrf-token",
                    "shortlink": "https://sg.run/N0Bp",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 73471,
                            "rule_id": "PeUyYG",
                            "rule_name": "python.django.security.django-no-csrf-token.django-no-csrf-token",
                            "rv_id": 946160,
                            "url": "https://semgrep.dev/playground/r/BjT1NRl/python.django.security.django-no-csrf-token.django-no-csrf-token",
                            "version_id": "BjT1NRl"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    },
                    "semgrep.url": "https://semgrep.dev/r/python.django.security.django-no-csrf-token.django-no-csrf-token",
                    "semgrep.ruleset": "default",
                    "semgrep.ruleset_id": 3471
                },
                "severity": "WARNING",
                "fingerprint": "474e9ed0da75841ee43b1c789a384ef5327ae5bf6418174e6d1da7f903a264f6818042d7563da0ccd3cf03f443491f9bf043e76fb34d9b166d9b7521f4a345c3_0",
                "lines": "    <form method=\"POST\">\n        <label for=\"username\">Username:</label>\n        <input type=\"text\" id=\"username\" name=\"username\" required>\n        <br><br>\n\n        <label for=\"password\">Password:</label>\n        <input type=\"password\" id=\"password\" name=\"password\" required>\n        <br><br>\n\n        <button type=\"submit\">Login</button>\n    </form>",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "engine_kind": "PRO"
            }
        },
        {
            "check_id": "ash982.php-to-c-system-taint",
            "path": "CrossLang/PHPToC/php/index.php",
            "start": {
                "line": 15,
                "col": 5,
                "offset": 345
            },
            "end": {
                "line": 15,
                "col": 32,
                "offset": 372
            },
            "extra": {
                "metavars": {},
                "message": "Potential security risk: Tainted user input flows from PHP to C system().",
                "metadata": {
                    "source": "https://semgrep.dev/s/5rBnK",
                    "shortlink": "https://semgrep.dev/s/5rBnK",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "custom",
                            "r_id": 151903,
                            "rule_id": "lBU4ONZ",
                            "rule_name": "ash982.php-to-c-system-taint",
                            "rv_id": 975774,
                            "url": "https://semgrep.dev/playground/r/6xTx0bn/ash982.php-to-c-system-taint",
                            "version_id": "6xTx0bn"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    }
                },
                "severity": "ERROR",
                "fingerprint": "bc2a2ed85a180574b2e05838cd410edb2c230417f1436ce691dbd1fb6a67a4581e287719029c1252d909c674fcd8f4b233bb239b8bdc82a5217326aafa9e358b_0",
                "lines": "    run_shell_command($command);",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "dataflow_trace": {
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 6,
                                    "col": 16,
                                    "offset": 133
                                },
                                "end": {
                                    "line": 6,
                                    "col": 22,
                                    "offset": 139
                                }
                            },
                            "$_POST"
                        ]
                    ],
                    "intermediate_vars": [
                        {
                            "location": {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 6,
                                    "col": 5,
                                    "offset": 122
                                },
                                "end": {
                                    "line": 6,
                                    "col": 13,
                                    "offset": 130
                                }
                            },
                            "content": "$command"
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 15,
                                    "col": 5,
                                    "offset": 345
                                },
                                "end": {
                                    "line": 15,
                                    "col": 32,
                                    "offset": 372
                                }
                            },
                            "run_shell_command($command)"
                        ]
                    ]
                },
                "engine_kind": "PRO"
            }
        },
        {
            "check_id": "php.lang.security.taint-unsafe-echo-tag.taint-unsafe-echo-tag",
            "path": "CrossLang/PHPToC/php/index.php",
            "start": {
                "line": 17,
                "col": 5,
                "offset": 379
            },
            "end": {
                "line": 17,
                "col": 44,
                "offset": 418
            },
            "extra": {
                "metavars": {
                    "$1": {
                        "start": {
                            "line": 1,
                            "col": 3,
                            "offset": 2
                        },
                        "end": {
                            "line": 1,
                            "col": 7,
                            "offset": 6
                        },
                        "abstract_content": "POST"
                    },
                    "$REQ": {
                        "start": {
                            "line": 6,
                            "col": 16,
                            "offset": 133
                        },
                        "end": {
                            "line": 6,
                            "col": 22,
                            "offset": 139
                        },
                        "abstract_content": "$_POST"
                    }
                },
                "message": "Found direct access to a PHP variable wihout HTML escaping inside an inline PHP statement setting data from `$_REQUEST[...]`. When untrusted input can be used to tamper with a web page rendering, it can lead to a Cross-site scripting (XSS) vulnerability. XSS vulnerabilities occur when untrusted input executes malicious JavaScript code, leading to issues such as account compromise and sensitive information leakage. To prevent this vulnerability, validate the user input, perform contextual output encoding or sanitize the input. In PHP you can encode or sanitize user input with `htmlspecialchars` or use automatic context-aware escaping with a template engine such as Latte.",
                "metadata": {
                    "likelihood": "HIGH",
                    "impact": "MEDIUM",
                    "confidence": "MEDIUM",
                    "category": "security",
                    "subcategory": [
                        "vuln"
                    ],
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::http-params::lang",
                        "web::source::http-body::lang",
                        "web::sink::html-webpage::lang"
                    ],
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://www.php.net/manual/en/language.basic-syntax.phptags.php"
                    ],
                    "technology": [
                        "php"
                    ],
                    "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ],
                    "source": "https://semgrep.dev/r/php.lang.security.taint-unsafe-echo-tag.taint-unsafe-echo-tag",
                    "shortlink": "https://sg.run/RlGe",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 27193,
                            "rule_id": "r6UA0y",
                            "rule_name": "php.lang.security.taint-unsafe-echo-tag.taint-unsafe-echo-tag",
                            "rv_id": 947718,
                            "url": "https://semgrep.dev/playground/r/ExTg4yR/php.lang.security.taint-unsafe-echo-tag.taint-unsafe-echo-tag",
                            "version_id": "ExTg4yR"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    },
                    "semgrep.url": "https://semgrep.dev/r/php.lang.security.taint-unsafe-echo-tag.taint-unsafe-echo-tag",
                    "semgrep.ruleset": "default",
                    "semgrep.ruleset_id": 3471
                },
                "severity": "WARNING",
                "fingerprint": "53178f7b1a321ba0b7d5de25e6a348bcdf8378264089c4e46c8f63f7b39b131cdd2e15aac5a8d680a4972d71a21c24d549e6d31a46ea5bba67304b21e91c82fb_0",
                "lines": "    echo \"Command executed: $safe_command\";",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "dataflow_trace": {
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 6,
                                    "col": 16,
                                    "offset": 133
                                },
                                "end": {
                                    "line": 6,
                                    "col": 33,
                                    "offset": 150
                                }
                            },
                            "$_POST['command']"
                        ]
                    ],
                    "intermediate_vars": [
                        {
                            "location": {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 6,
                                    "col": 5,
                                    "offset": 122
                                },
                                "end": {
                                    "line": 6,
                                    "col": 13,
                                    "offset": 130
                                }
                            },
                            "content": "$command"
                        },
                        {
                            "location": {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 9,
                                    "col": 5,
                                    "offset": 213
                                },
                                "end": {
                                    "line": 9,
                                    "col": 18,
                                    "offset": 226
                                }
                            },
                            "content": "$safe_command"
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "path": "CrossLang/PHPToC/php/index.php",
                                "start": {
                                    "line": 17,
                                    "col": 5,
                                    "offset": 379
                                },
                                "end": {
                                    "line": 17,
                                    "col": 44,
                                    "offset": 418
                                }
                            },
                            "echo \"Command executed: $safe_command\";"
                        ]
                    ]
                },
                "engine_kind": "PRO"
            }
        },
        {
            "check_id": "ash982.swig-to-c-system-taint",
            "path": "CrossLang/PHPToC/src/command.c",
            "start": {
                "line": 7,
                "col": 5,
                "offset": 144
            },
            "end": {
                "line": 7,
                "col": 20,
                "offset": 159
            },
            "extra": {
                "metavars": {
                    "$FUNC": {
                        "start": {
                            "line": 6,
                            "col": 6,
                            "offset": 99
                        },
                        "end": {
                            "line": 6,
                            "col": 23,
                            "offset": 116
                        },
                        "abstract_content": "run_shell_command"
                    }
                },
                "message": "Tainted input from SWIG interface passed to system().",
                "metadata": {
                    "source": "https://semgrep.dev/s/oqO6d",
                    "shortlink": "https://semgrep.dev/s/oqO6d",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "custom",
                            "r_id": 151916,
                            "rule_id": "lBU4ONg",
                            "rule_name": "ash982.swig-to-c-system-taint",
                            "rv_id": 975704,
                            "url": "https://semgrep.dev/playground/r/JdTDe7y/ash982.swig-to-c-system-taint",
                            "version_id": "JdTDe7y"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    }
                },
                "severity": "ERROR",
                "fingerprint": "632defdcec8b160869363995c242baaef4ce6b1be19ffe348b5ec869bea3b70db0d9f0135c597cbb465370ef152308fde95fc2da441da7fb570f44aa29c1a247_0",
                "lines": "    system(command);",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "engine_kind": "PRO"
            }
        },
        {
            "check_id": "cpp.lang.security.system-command.dont-call-system.dont-call-system",
            "path": "CrossLang/PHPToC/src/command.c",
            "start": {
                "line": 7,
                "col": 5,
                "offset": 144
            },
            "end": {
                "line": 7,
                "col": 21,
                "offset": 160
            },
            "extra": {
                "metavars": {},
                "message": "Don't call `system`. It's a high-level wrapper that allows for stacking multiple commands. Always prefer a more restrictive API such as calling `execve` from the `exec` family.",
                "metadata": {
                    "likelihood": "MEDIUM",
                    "impact": "HIGH",
                    "confidence": "HIGH",
                    "category": "security",
                    "subcategory": [
                        "audit"
                    ],
                    "cwe": [
                        "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
                    ],
                    "cwe2020-top25": true,
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "display-name": "OS Command Injection",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A03_2021-Injection"
                    ],
                    "technology": [
                        "cpp"
                    ],
                    "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
                    "vulnerability_class": [
                        "Command Injection"
                    ],
                    "source": "https://semgrep.dev/r/cpp.lang.security.system-command.dont-call-system.dont-call-system",
                    "shortlink": "https://sg.run/BYWWx",
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 114895,
                            "rule_id": "6JUv88x",
                            "rule_name": "cpp.lang.security.system-command.dont-call-system.dont-call-system",
                            "rv_id": 947262,
                            "url": "https://semgrep.dev/playground/r/QkTZ60P/cpp.lang.security.system-command.dont-call-system.dont-call-system",
                            "version_id": "QkTZ60P"
                        },
                        "src": "unchanged"
                    },
                    "dev.semgrep.actions": [
                        "monitor"
                    ],
                    "semgrep.policy": {
                        "id": 86477,
                        "name": "Rule Board - Audit column",
                        "slug": "rule-board-audit"
                    },
                    "semgrep.url": "https://semgrep.dev/r/cpp.lang.security.system-command.dont-call-system.dont-call-system",
                    "semgrep.ruleset": "default",
                    "semgrep.ruleset_id": 3471
                },
                "severity": "INFO",
                "fingerprint": "092985e32197a91d723f49e73a25a69146c47f5e9a4d0eac5a3d0c1c161c0d439f2c5c315bf0f210d6733ba3dbd598dff94c78f966ce98b8b6cf376e9bd7a56a_0",
                "lines": "    system(command);",
                "is_ignored": false,
                "validation_state": "NO_VALIDATOR",
                "engine_kind": "PRO"
            }
        }
    ],
    "errors": [
        {
            "code": 3,
            "level": "warn",
            "type": [
                "PartialParsing",
                [
                    {
                        "path": "CrossLang/PHPToC/joern-install.sh",
                        "start": {
                            "line": 22,
                            "col": 13,
                            "offset": 0
                        },
                        "end": {
                            "line": 22,
                            "col": 14,
                            "offset": 1
                        }
                    }
                ]
            ],
            "message": "Syntax error at line CrossLang/PHPToC/joern-install.sh:22:\n `2` was unexpected",
            "path": "CrossLang/PHPToC/joern-install.sh",
            "spans": [
                {
                    "file": "CrossLang/PHPToC/joern-install.sh",
                    "start": {
                        "line": 22,
                        "col": 13,
                        "offset": 0
                    },
                    "end": {
                        "line": 22,
                        "col": 14,
                        "offset": 1
                    }
                }
            ]
        }
    ],
    "paths": {
        "scanned": [
            ".DS_Store",
            ".github/workflows/semgrep.yml",
            "BigQuery-Python/README",
            "BigQuery-Python/app.py",
            "BigQuery-Python/bq_client.py",
            "BigQuery-Python/config.py",
            "BigQuery-Python/requirements.txt",
            "BigQuery-Python/routes.py",
            "BigQuery-Python/schema.xml",
            "BigQuery-Python/schema_validator.py",
            "BigQuery-Python/templates/index.html",
            "BigQuery-Python/templates/login.html",
            "BigQuery-Python/templates/logout.html",
            "CrossLang/.DS_Store",
            "CrossLang/PHPToC/.DS_Store",
            "CrossLang/PHPToC/Makefile",
            "CrossLang/PHPToC/README",
            "CrossLang/PHPToC/c-rules.yaml",
            "CrossLang/PHPToC/config/php.ini",
            "CrossLang/PHPToC/joern-install.sh",
            "CrossLang/PHPToC/php/index.php",
            "CrossLang/PHPToC/php/php.ini",
            "CrossLang/PHPToC/php-rules.yaml",
            "CrossLang/PHPToC/php2c.yaml",
            "CrossLang/PHPToC/phpsource.json",
            "CrossLang/PHPToC/src/README",
            "CrossLang/PHPToC/src/command.c",
            "CrossLang/PHPToC/src/command.h",
            "CrossLang/PHPToC/src/command.i",
            "CrossLang/PHPToC/src/command2.i",
            "CrossLang/PythonToC/README",
            "CrossLang/php-findings.json",
            "Neo4jInjection/README",
            "WebAPI/GraphQL/README",
            "WebAPI/REST/README"
        ]
    },
    "interfile_languages_used": [],
    "skipped_rules": []
}